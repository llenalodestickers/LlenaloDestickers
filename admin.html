<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin | LlenaloD Stickers</title>
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/nav.css">
  <link rel="stylesheet" href="css/admin.css">
  <link rel="stylesheet" href="css/footer.css">
</head>
<body>
  <header class="nav">
    <div class="nav-top">
      <h1>LlenaloDstickers</h1>
      <div class="nav-actions">
        <a class="nav-pill nav-link" href="index.html">Catalogo</a>
        <span class="nav-pill admin-pill">Panel Admin</span>
      </div>
    </div>
  </header>

  <main class="admin-wrap">
    <header class="admin-header">
      <h1>Panel de Pedidos</h1>
      <p>Listado de pedidos y datos de clientes.</p>
      <div class="admin-actions">
        <button id="refreshBtn" type="button">Actualizar</button>
        <a class="admin-link" href="index.html">Volver al catalogo</a>
      </div>
    </header>

    <section class="admin-kpis">
      <article class="kpi">
        <span>Total pedidos</span>
        <strong id="kpiPedidos">0</strong>
      </article>
      <article class="kpi">
        <span>Total facturado</span>
        <strong id="kpiTotal">$0</strong>
      </article>
    </section>

    <section class="admin-finanzas">
      <header class="admin-finanzas-header">
        <h2>Caja Local</h2>
        <p>Resumen de ingresos y egresos. Incluye ventas del catalogo y movimientos manuales (ferias, personalizados, otros).</p>
      </header>

      <section class="admin-kpis admin-kpis-finanzas">
        <article class="kpi">
          <span>Ingresos</span>
          <strong id="kpiIngresos">$0</strong>
        </article>
        <article class="kpi">
          <span>Egresos</span>
          <strong id="kpiEgresos">$0</strong>
        </article>
        <article class="kpi">
          <span>Balance</span>
          <strong id="kpiBalance">$0</strong>
        </article>
      </section>

      <form id="movimientoForm" class="movimiento-form">
        <label>
          Tipo
          <select id="movTipo" required>
            <option value="ingreso">Ingreso</option>
            <option value="egreso">Egreso</option>
          </select>
        </label>
        <label>
          Origen
          <select id="movOrigen" required>
            <option value="feria">Feria</option>
            <option value="personalizado">Personalizado</option>
            <option value="otro">Otro</option>
          </select>
        </label>
        <label>
          Monto
          <input id="movMonto" type="number" min="1" step="1" placeholder="0" required>
        </label>
        <label class="movimiento-descripcion">
          Descripcion
          <input id="movDescripcion" type="text" maxlength="120" placeholder="Ej: Venta en feria Plaza - puesto 12" required>
        </label>
        <label>
          Fecha
          <input id="movFecha" type="datetime-local" required>
        </label>
        <button type="submit">Agregar movimiento</button>
      </form>

      <section class="admin-table-wrap">
        <table class="admin-table">
          <thead>
            <tr>
              <th>Fecha</th>
              <th>Tipo</th>
              <th>Origen</th>
              <th>Descripcion</th>
              <th>Monto</th>
              <th>Fuente</th>
              <th>Accion</th>
            </tr>
          </thead>
          <tbody id="cajaBody">
            <tr>
              <td colspan="7">Cargando...</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>

    <section class="admin-table-wrap">
      <table class="admin-table">
        <thead>
          <tr>
            <th>Fecha</th>
            <th>Nro</th>
            <th>Cliente</th>
            <th>WhatsApp</th>
            <th>Items</th>
            <th>Total</th>
            <th>Estado</th>
            <th>Accion</th>
          </tr>
        </thead>
        <tbody id="pedidosBody">
          <tr>
            <td colspan="8">Cargando...</td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>

  <!-- Modal para editar pedido -->
  <div id="editarPedidoModal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="modal-close" onclick="cerrarModalEditarPedido()">&times;</span>
      <h2>Editar Pedido</h2>
      <form id="editarPedidoForm">
        <input type="hidden" id="editPedidoId">
        <label>
          Cliente
          <input type="text" id="editClienteNombre" maxlength="100" required>
        </label>
        <label>
          WhatsApp
          <input type="text" id="editClienteWhatsapp" maxlength="30" required>
        </label>
        <div class="modal-actions">
          <button type="submit">Guardar</button>
          <button type="button" onclick="cerrarModalEditarPedido()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal para editar movimiento -->
  <div id="editarMovimientoModal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="modal-close" onclick="cerrarModalEditarMovimiento()">&times;</span>
      <h2>Editar Movimiento</h2>
      <form id="editarMovimientoForm">
        <input type="hidden" id="editMovimientoId">
        <label>
          Tipo
          <select id="editMovTipo" required>
            <option value="ingreso">Ingreso</option>
            <option value="egreso">Egreso</option>
          </select>
        </label>
        <label>
          Origen
          <select id="editMovOrigen" required>
            <option value="feria">Feria</option>
            <option value="personalizado">Personalizado</option>
            <option value="otro">Otro</option>
          </select>
        </label>
        <label>
          Monto
          <input type="number" id="editMovMonto" min="1" step="1" required>
        </label>
        <label>
          Descripcion
          <input type="text" id="editMovDescripcion" maxlength="120" required>
        </label>
        <label>
          Fecha
          <input type="datetime-local" id="editMovFecha" required>
        </label>
        <div class="modal-actions">
          <button type="submit">Guardar</button>
          <button type="button" onclick="cerrarModalEditarMovimiento()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <script src="js/backend.js"></script>
  <script src="js/admin.js"></script>

  <footer class="footer">
    <div class="footer-grid">
      <div>
        <h3>LlenaloDStickers</h3>
        <p>Gestion de pedidos y clientes desde el panel admin.</p>
      </div>
      <div>
        <h3>Accesos</h3>
        <a href="index.html">Ir al catalogo</a>
      </div>
      <div>
        <h3>Contacto</h3>
        <p>WhatsApp: 11 7363-3880</p>
      </div>
    </div>
    <div class="footer-copy">
      Año 2026 LlenaloDstickers
    </div>
  </footer>
</body>
</html>
